<section class="main-content-body" xmlns="http://www.w3.org/1999/html"><?php $this->view('page/dashboard-icon-menu/index'); ?><div class="container"><div class="row-fluid"><div class="span12" style="padding-top: 55px"><div class="table-area"><div class="row-fluid cnote-table-menu-bg">    <div class="span12">        <ul class="cnote-table-menu">            <li style="width: 50%;" class="cnote-table-menu-active">                <a class="cnote-table-menu-white" href="<?php echo base_url('notes/page') ?>">All Notes</a>            </li>            <li style="width: 50%;"><a class="cnote-table-menu-blue"                    href="<?php echo base_url('user/staff-list') ?>">All Staff</a>            </li>            <!-- <li><a class="cnote-table-menu-green" href="#">Opened(97)</a></li>             <li><a class="cnote-table-menu-black" href="#">Unopened(36)</a></li>             <li><a class="cnote-table-menu-red" href="#">Undelivered(3)</a></li>-->        </ul>    </div></div><div class="row-fluid table-area-header">    <h3>CloudeNotes List</h3></div><div class="row-fluid table-area-filter-bg">    <div class="span4">        <!--<div class="span4">            <ul id="table-footer">                <li style="display: none"><input type="checkbox" name="checkall" class="data-check-parent"></li>                <li style="display: none"></li>                <li>Note Name</li>                <li>Date Sent</li>                <li>Reply By</li>                <li style="display: none"># of Students</li>                <li style="display: none">Consents</li>                <li style="display: none">Non-Consents</li>                <li style="display: none">Not-Replied</li>                <li style="display: none">Received</li>            </ul>        </div>-->    </div>    <div class="span3">        <div class="student-form-group">            <label for="User Filter">Action</label>            <select id="action-filter" class="selectpicker">                <option selected="selected">Select Action</option>                <option value="view_all_results">View All Results</option>                <option value="view_all_consents">Consents</option>                <option value="view_all_non_consents">Non-Consents</option>                <option value="view_note_not_replied">Not Replied</option>                <!--<option value="send_cloudenotes">Payment Received</option>-->                <option value="view_note">View Note</option>                <!-- <option value="send_reminders">Archive Notes</option>-->                <option value="delete_note">Delete Notes</option>            </select>        </div>    </div>    <div class="span3">        <div class="student-form-group">        </div>    </div></div><div class="row-fluid">    <div class="span12">        <div id="demo">            <?php if ($note_list == false) {                echo '<div class="alert alert-info"><strong>No Data Available </strong></div>';            } else {                ?>                <table cellpadding="0" cellspacing="0" border="0" class="display" id="noteform">                    <thead>                    <tr>                        <th style="text-align: left"><input type="checkbox" name="checkall"                                class="data-check-parent"></th>                        <th style="display: none;"></th>                        <th style="text-align: left"></th>                        <th style="text-align: left">Note Name</th>                        <th style="text-align: left">Date Sent</th>                        <th style="text-align: left">Reply By</th>                        <th style="text-align: left"># of Students</th>                        <th style="text-align: left"><i class="fa fa-check"></i> Consents</th>                        <th style="text-align: left"><i class="fa fa-times"></i> Non-Consents</th>                        <th style="text-align: left"><i class="fa fa-warning"></i> Not-Replied</th>                        <!--<th style="text-align: left"><i class="fa fa-dollar"></i> Received</th>-->                    </tr>                    </thead>                    <tbody>                    <?php $i = 0;                    $total_student_in_per_note = 0;                    $total_parent_consent = 0;                    $total_parent_non_consent = 0;                    $total_not_replied = 0;                    ?>                    <?php foreach ($note_list as $row): //echo "<pre>";print_r($row);?>                        <tr>                            <td><input type="checkbox" name="data[1][id]" value="1" class="data-check">                            </td>                            <td style="display: none;"><?php echo $row->note_id; ?></td>                            <td><?php echo ++$i; ?></td>                            <td>                                <a href="<?php echo base_url('notes/edit/' . $row->note_id) ?>" target="_blank"><?php echo $row->note_name; ?></a>                            </td>                            <td><?php echo ($row->note_schedule_date != '') ? date("d-M-Y", strtotime($row->note_schedule_date)) : " "; ?></td>                            <td><?php echo $row->note_reply_end_date; ?></td>                            <td><?php                                echo (!isset($row->student_per_note) || $row->student_per_note == '') ? "0" : $row->student_per_note; ?></td>                            <td><?php                                echo (!isset($row->parent_consent) || $row->parent_consent == '') ? "0" : $row->parent_consent; ?></td>                            <td><?php                                echo (!isset($row->parent_non_consent) || $row->parent_non_consent == '') ? "0" : $row->parent_non_consent; ?></td>                            <td><?php                                echo (!isset($row->not_replied) || $row->not_replied == '') ? "0" : $row->not_replied; ?></td>                            <!--<td><?php /* echo "0";                                // echo (!isset($row->student_per_note) || $row->student_per_note == '') ? 0 : $row->student_per_note;                                */?></td>-->                            <?php $total_student_in_per_note += $row->student_per_note;                            $total_parent_consent += $row->parent_consent;                            $total_parent_non_consent += $row->parent_non_consent;                            $total_not_replied += $row->not_replied;                            //$total_student_in_per_note += $row->student_per_note;                            ?>                            <!--<td class="action-btn"><a href="<?php /*echo base_url('notes/view/'.$row->note_id); */?>"><button class="btn btn-success"><i class="fa fa-user"></i></button></a></td>                                        <td class="action-btn"><a href="<?php /*echo base_url('notes/edit/'.$row->note_id); */?>"><button class="btn btn-primary"><i class="fa fa-pencil"></i></button></a></td>                                        <td class="action-btn"><a href="<?php /*echo base_url('notes/remove/'.$row->note_id); */?>" onclick="return confirm('Are you sure want to delete this notes?')"><button class="btn btn-danger"><i class="fa fa-trash-o"></i></button></a></td>-->                        </tr>                    <?php endforeach; ?>                    </tbody>                    <tfoot>                    <th></th>                    <th></th>                    <th></th>                    <th></th>                    <th>Total:</th>                    <th><?php echo $total_student_in_per_note; ?></th>                    <th><?php echo $total_parent_consent; ?></th>                    <th><?php echo $total_parent_non_consent; ?></th>                    <th><?php echo $total_not_replied; ?></th>                    <!--<th>3336</th>-->                    </tfoot>                </table>            <?php } ?>        </div>    </div></div><!--<div class="row-fluid table-area-filter-bg">      <div class="span4 selected-stu">      </div>      <div class="span4">            <div class="pagination">                  <?php /*echo $pagination; */?>            </div>      </div>      <div class="span4 selected-stu">            <p></p>      </div></div>--><div class="row-fluid">    <div class="span3 offset9 steps">    </div></div></div></div></div></div><div id="note_modal" class="modal hide fade in" style="display: none; ">    <div class="modal-header">        <a class="close" data-dismiss="modal">Ã—</a>        <h3></h3>    </div>    <div class="modal-body">        <h4></h4>        <h6></h6>        <div class="select_moveto_class" style="display: none;">            <?php // $this->view('page/auth_user/staff_invite'); ?>        </div>    </div>    <div class="modal-footer">        <a href="#" id="move_member" class="btn btn-success">Move</a>        <a href="#" id="closenRefresh" class="btn" data-dismiss="modal">Close</a>    </div></div><script type="text/javascript">(function ($) {    $.fn.dataTableExt.oApi.fnGetColumnData = function (oSettings, iColumn, bUnique, bFiltered, bIgnoreEmpty) {        if (typeof iColumn == "undefined")            return new Array();        if (typeof bUnique == "undefined") bUnique = true;        if (typeof bFiltered == "undefined") bFiltered = true;        if (typeof bIgnoreEmpty == "undefined") bIgnoreEmpty = true;        var aiRows;        if (bFiltered == true) aiRows = oSettings.aiDisplay;        else aiRows = oSettings.aiDisplayMaster;        var asResultData = new Array();        for (var i = 0, c = aiRows.length; i < c; i++) {            iRow = aiRows[i];            var aData = this.fnGetData(iRow);            var sValue = aData[iColumn];            if (bIgnoreEmpty == true && sValue.length == 0) continue;            else if (bUnique == true && jQuery.inArray(sValue, asResultData) > -1) continue;            else asResultData.push(sValue);        }        return asResultData;    }}(jQuery));function fnCreateSelect(aData, heading) {    var r = '<select id="selectOption' + heading + '"><option value="">' + heading + '</option>', i, iLen = aData.length;    for (i = 0; i < iLen; i++) {        r += '<option value="' + aData[i] + '">' + aData[i] + '</option>';    }    return r + '</select>';}$(document).ready(function () {    var noteTable = $("#noteform").dataTable({        "bLengthChange": false,        "bPaginate": true,        "bFiltered": true,        "iDisplayLength": 10,        "aoColumnDefs": [            { 'bSortable': false, 'aTargets': [ 0, 1 ] }        ]    });    function removeNewlines(str) {        str = str.replace(/\s{2,}/g, ' ');        str = str.replace(/\t/g, ' ');        str = str.replace(/\n{2,}/g, ' ');        str = str.toString().trim().replace(/(\r\n|\n|\r)/g, "");        return str;    }    $("#noteform_info").hide();    var flag;    $('.data-check-parent').on('change', function () {        if ($(this).is(':checked')) {            flag = 0;            $('.data-check').attr('checked', true);        } else {            flag = 1;            $('.data-check').attr('checked', false);        }    });    $("#action-filter").on('change', function () {        var selectedOpt = $(this).val();        if (selectedOpt == 'view_all_results') {            var staffchecked = $("input:checked").length;            if (staffchecked == 1) {                var viewArr = [];                $.each($("input[type=checkbox]:checked"), function () {                    var checkedVal = $(this).parent().parent().text();                    var removeNewLines = removeNewlines(checkedVal);                    singleElement = removeNewLines.split(' ');                    viewArr.push(singleElement[0]);                });                var url = "<?php echo base_url('note/note-result'); ?>";                window.location = url + '/' + viewArr;            } else {                $("#note_modal").modal();                $(".modal-header h3").html("View All Results");                $(".modal-body h4").html("Please Select One Note");                $(".modal-body h6").html("Hit close to refresh the page!");                $(".modal-body .select_moveto_class").hide();                $("#move_member").hide();                $("#closenRefresh").on('click', function () {                    window.location = "<?php echo base_url('notes/page'); ?>";                });            }        }else if (selectedOpt == 'view_all_consents') {            var staffchecked = $("input:checked").length;            if (staffchecked == 1) {                var viewArr = [];                $.each($("input[type=checkbox]:checked"), function () {                    var checkedVal = $(this).parent().parent().text();                    var removeNewLines = removeNewlines(checkedVal);                    singleElement = removeNewLines.split(' ');                    viewArr.push(singleElement[0]);                });                var url = "<?php echo base_url('note/note-consent'); ?>";                window.location = url + '/' + viewArr;            } else {                $("#note_modal").modal();                $(".modal-header h3").html("View All Consents");                $(".modal-body h4").html("Please Select One Note");                $(".modal-body h6").html("Hit close to refresh the page!");                $(".modal-body .select_moveto_class").hide();                $("#move_member").hide();                $("#closenRefresh").on('click', function () {                    window.location = "<?php echo base_url('notes/page'); ?>";                });            }        }else if (selectedOpt == 'view_all_non_consents') {            var staffchecked = $("input:checked").length;            if (staffchecked == 1) {                var viewArr = [];                $.each($("input[type=checkbox]:checked"), function () {                    var checkedVal = $(this).parent().parent().text();                    var removeNewLines = removeNewlines(checkedVal);                    singleElement = removeNewLines.split(' ');                    viewArr.push(singleElement[0]);                });                var url = "<?php echo base_url('note/note-non-consent'); ?>";                window.location = url + '/' + viewArr;            } else {                $("#note_modal").modal();                $(".modal-header h3").html("View All Non-Consents");                $(".modal-body h4").html("Please Select One Note");                $(".modal-body h6").html("Hit close to refresh the page!");                $(".modal-body .select_moveto_class").hide();                $("#move_member").hide();                $("#closenRefresh").on('click', function () {                    window.location = "<?php echo base_url('notes/page'); ?>";                });            }        }else if (selectedOpt == 'view_note_not_replied') {            var staffchecked = $("input:checked").length;            if (staffchecked == 1) {                var viewArr = [];                $.each($("input[type=checkbox]:checked"), function () {                    var checkedVal = $(this).parent().parent().text();                    var removeNewLines = removeNewlines(checkedVal);                    singleElement = removeNewLines.split(' ');                    viewArr.push(singleElement[0]);                });                var url = "<?php echo base_url('note/note-not-replied'); ?>";                window.location = url + '/' + viewArr;            } else {                $("#note_modal").modal();                $(".modal-header h3").html("View All Not Replied");                $(".modal-body h4").html("Please Select One Note");                $(".modal-body h6").html("Hit close to refresh the page!");                $(".modal-body .select_moveto_class").hide();                $("#move_member").hide();                $("#closenRefresh").on('click', function () {                    window.location = "<?php echo base_url('notes/page'); ?>";                });            }        } else if (selectedOpt == 'view_note') {            var staffchecked = $("input:checked").length;            if (staffchecked == 1) {                var viewArr = [];                $.each($("input[type=checkbox]:checked"), function () {                    var checkedVal = $(this).parent().parent().text();                    var removeNewLines = removeNewlines(checkedVal);                    singleElement = removeNewLines.split(' ');                    viewArr.push(singleElement[0]);                });                var url = "<?php echo base_url('notes/edit'); ?>";                window.location = url + '/' + viewArr;            } else {                $("#note_modal").modal();                $(".modal-header h3").html("View Note");                $(".modal-body h4").html("Please Select One Note");                $(".modal-body h6").html("Hit close to refresh the page!");                $(".modal-body .select_moveto_class").hide();                $("#move_member").hide();                $("#closenRefresh").on('click', function () {                    window.location = "<?php echo base_url('notes/page'); ?>";                });            }        } else if (selectedOpt == 'delete_note') {            var staffchecked = $("input:checked").length;            console.log(staffchecked);            if (staffchecked > 0) {                var deleteArr = [];                $.each($("input[type=checkbox]:checked"), function () {                    var checkedVal = $(this).parent().parent().text(); /*getting each choosen data from data-table*/                    var removeNewLines = removeNewlines(checkedVal);       /*removing the new lines*/                    singleElement = removeNewLines.split(' ');      /*  making the string an array*/                    deleteArr.push(singleElement[0]);                      /*pushing the collected data into dataArray which will go to the modal*/                    /*console.log(singleElement);*/                });                if (flag == 0) {                    deleteArr.splice(0, 2); /*remove first two index as data table row will be in the text value item.*/                }                $("#note_modal").modal();                $(".modal-header h3").html("Delete Note");                $(".modal-body h4").html("Are you sure you want to delete?");                $(".modal-body .select_moveto_class").hide();                $(".modal-body h6").html("Hit close to refresh the page!");                $("#move_member").text("Yes");                $("#closenRefresh").text("No").on('click', function () {                    window.location = "<?php echo base_url('notes/page'); ?>";                });                $("#move_member").on('click', function () {/*                    console.log('clicked');*/                    $.ajax({                        url: "<?php echo base_url('note/post-ajax-del-note'); ?>",                        type: "POST",                        async: false,                        data: {deleteArr: deleteArr},                        success: function (response) {                            console.log(response);                            ajaxResponse = jQuery.parseJSON(response);                            if (parseInt(ajaxResponse.output)) {                                $(".modal-body h4").hide();                                $("#move_member").hide();                                $(".modal-body .select_moveto_class").hide();                                $(".modal-body").html("<h4>Note Deleted Successfully!</h4>");                                $("#closenRefresh").text('Close').on('click', function () {                                    window.location = "<?php echo base_url('notes/page'); ?>";                                });                            } else {                                console.log('false');                                $(".modal-body h4").hide();                                $(".modal-body .select_moveto_class").hide();                                $("#move_member").hide();                                $(".modal-body").html("<h4>Something Wrong! Please Check Again.</h4>");                                $("#delclosenRefresh").on('click', function () {                                    window.location = "<?php echo base_url('notes/page'); ?>";                                });                            }                        },                        error: function (request, status, error) {                            console.log("something fishy!");                        }                    });                });            } else {                $("#note_modal").modal();                $(".modal-header h3").html("Delete Note");                $(".modal-body h4").html("Please Select One Note");                $(".modal-body h6").html("Hit close to refresh the page!");                $(".modal-body .select_moveto_class").hide();                $("#move_member").hide();                $("#closenRefresh").on('click', function () {                    window.location = "<?php echo base_url('notes/page'); ?>";                });            }        }    });});</script></section>